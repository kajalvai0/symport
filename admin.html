<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <title>এডমিন প্যানেল</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script>
        // Your Firebase config (from project settings)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "mp-portal-nawga.firebaseapp.com",
            projectId: "mp-portal-nawga",
            storageBucket: "mp-portal-nawga.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // Admin login
        function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => loadDashboard())
                .catch(error => alert('লগইন ত্রুটি: ' + error.message));
        }
        
        // Load dashboard data
        function loadDashboard() {
            // Load statistics
            db.collection("stats").doc("current").get()
                .then(doc => {
                    document.getElementById('problems').value = doc.data().problems_solved;
                    document.getElementById('meetings').value = doc.data().meetings;
                });
            
            // Load recent submissions
            db.collection("submissions").limit(10).get()
                .then(querySnapshot => {
                    const submissionsList = document.getElementById('submissions');
                    submissionsList.innerHTML = '';
                    
                    querySnapshot.forEach(doc => {
                        const data = doc.data();
                        submissionsList.innerHTML += `
                            <div class="submission">
                                <h3>${data.type} - ${data.location}</h3>
                                <p>${data.description}</p>
                                <small>${data.timestamp.toDate().toLocaleDateString()}</small>
                            </div>
                        `;
                    });
                });
        }
        
        // Update statistics
        function updateStats() {
            db.collection("stats").doc("current").update({
                problems_solved: parseInt(document.getElementById('problems').value),
                meetings: parseInt(document.getElementById('meetings').value)
            }).then(() => alert('পরিসংখ্যান আপডেট সম্পন্ন!'));
        }
        
        // Auto-check login status
        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            }
        });
    </script>
</head>
<body>
    <div id="login-form">
        <h2>এডমিন লগইন</h2>
        <input type="email" id="email" placeholder="ইমেইল">
        <input type="password" id="password" placeholder="পাসওয়ার্ড">
        <button onclick="login()">লগইন</button>
    </div>
    
    <div id="dashboard" style="display:none">
        <h1>ড্যাশবোর্ড</h1>
        
        <h2>পরিসংখ্যান আপডেট</h2>
        <label>সমাধানকৃত সমস্যা: <input type="number" id="problems"></label>
        <label>গণসংযোগ: <input type="number" id="meetings"></label>
        <button onclick="updateStats()">সেভ করুন</button>
        
        <h2>সাম্প্রতিক আবেদন</h2>
        <div id="submissions"></div>
    </div>
</body>
  </html>
